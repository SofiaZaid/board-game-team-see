# Dokumentation
* Game engine
Vår webapplikation utgår i från vår Game klass. Där ligger all logik som har med spelet att göra. För att strukturera upp vårt projekt har vi valt att separera vår game-logik till en egen solution som heter gameengine. I GameEngine har vi konstruerat spellogiken utifrån hur det faktiska spelet Tre-i-rad fungerar oavsett huruvida det spelas via en digital lösning eller som ett traditionellt brädspel. 

* MailMappen
Denna mapp innehåller en klass: MailService som hanterar all logik som har med ett mailutskick att göra. I klassen finns enbart en metod: SendEmail vilken tar nickname och emailadress som argument. I metoden skapas en SMTP-server som används för att skicka ut mail till den spelare vars tur det är i spelet. Metoden anropas i controllern GameSessionController, i ActionResult-metoden "PlaceMark". Inuti denna metod anropas metoden SendEmail på ett objekt av typen MailService och utifrån att genom en lista tagit fram vilken spelare som för tillfället lägger ut en markör på brädet kan vi säga att nästa spelare i listan är motspelaren (opponentPlayer), motspelaren är då den som det kommer att skickas ut ett mail till (om att det är dennes tur att spela).

* Model View Controller
	* Model
	I vår Modelmapp har vi skapat två klasser för att hantera affärslogik som inte i diekt mening är kopplad till logiken för spelet och dess regler: "GameSession" och "Player". Klassen GameSession hanterar både spelet (Game) och den övriga logik som krävs för att hålla reda på en specifik GameSession. Dels behövs naturligtvis ett Game-objekt som innehåller logiken för spelet och dess regler, dels behövs en lista som ska innehålla de två spelarna som deltar i spelsessionen, för att kunna identifiera en specifik session behöver vi även ett "GameID". När ett spel skapas/ en spelsession initieras av en spelare (användare) är spelet ej ännu startat, därav finns variabeln "currentState", den initieras till "waiting" för att spelet ej ska kunna startas innan en andra spelare har anslutit sig. I konstruktorn för GameSession tas ett GameID in som parameter, ett Game-objekt instansieras, parameterns värde tilldelas till propertyn "GameID" samt att listobjektet "PlayersInSpecificGame" instansieras. 
För att hantera nödvändiga interaktioner med spelet utifrån ett Sessionsperspektiv skapade vi metoderna: JoinGame, StartGame och GameOver. JoinGame kontrollerar att det finns möjlighet att ansluta till en specifik spelsession, dvs. där finns ännu ej två spelare i sessionen och spelet är i staten "waiting". StartGame kontrollerar att "GameIsFull" har värdet "true", dvs. spelsessionen har två spelare och att spelsessionens state är "waiting", genom metoden ändras värdet på "currentState" ändras till "started"- spelsessionen är då startad. 
GameOver kontrollerar om någon av tre möjliga utfall är sanna: att en pågående spelsession inte längre har två spelare (en person har lämnat sessionen eller har av annan anledning hoppat ur sessionen), spelet har en vinnare eller spelbrädet är fullagt utan att någon har vunnit. 
Klassen Player är en klass bestående av enbart properties: egenskaper som kan knytas till en specifik spelare. Ett spelarobjekt får t.ex. ett specifikt Game-objekt kopplat till sig via propertyn "GameID". 
	* View
	För att tydliggöra att våra två Views båda är knutna till spelsessioner skapade vi en undermapp med namnet "GameSession". Vårt program har två Views: FirstPage och ShowGameBoard. 
FirstPage är den view som renderar lobbyn för spelet, dvs. den sida där man välkommnas till spelet och kan skapa en ny spelsession eller ur en lista välja en redan skapad spelsession som man vill delta i. I "FirstPage" konstruerade vi en helper-metod för att kunna rendera en lista över redan skapade spel som en andra spelare kan ansluta till. Denna helpermetod anropas inuti vår responsmetod Html.BeginForm("JoinGame", "GameSession"), en lista över öppna spel kommer då att visas i en drop-down meny. I "FirstPage" definierar vi även att när ActionResult-metoden "CreateGame" körs så ska värdena i dem två textfälten där man matar in nickname respektive mailadress för spelare X (spelaren som skapar spelsessionen) sparas till ett spelarobjekt. Sparandet av dessa värden sker indirekt, genom interaktionen med controllern och actionresult-metoden "CreateGame".

ShowGameBoard hanterar GUI:t och användarens interaktion med detta när en spelare väl är delaktig i en spelsession. För att en korrekt representation av spelbrädet ska visas utifrån vilka markörer som för tillfället finns placerade på brädet skapades helper-metoden "showMarkAt(int x, int y)". Denna metod interagerar med modellen genom propertyn "SpecificGame" i GameSession-objektet som refererar till ett specifikt "Game"-objekt, genom denna property kan vi anropa metoden "GetMarkAt" ur "Game"-klassen och beroende på vilken markör som finns på ett specifikt fält ska antingen X, O eller ingenting visas. I responsmetoden "Html.BeginForm("PlaceMark","GameSession", id = Model.GameID)" anropas helper-metoden "GetMarkAt" på varje button-objekt för att korrekt markör ska visas för varje knapp/fält vid varje givet tillfälle. I ShowGameBoard-viewen hanteras även vad som ska visas på webbsidan när någon av de två spelarna har vunnit, eller ifall spelet är över och det ej finns någon vinnare, detta hanteras genom anrop till metoden "GameOver" i "GameSession"-klassen. För att indikera för en spelare att spelet ej är startat, dvs. att det ännu ej finns en andra spelare ansluten anropas metoden "GameFull" i "GameSession"-klassen, om denna metod utvärderas till false ska texten "waiting for players..." visas. För att även visa en korrekt representation av vems tur det är att spela kontrolleras först ifall metoden "HasWinner" utvärderas till false, i sådana fall kontrolleras det vems tur det är genom att på "SpecificGame" anropa metoden "WhoIsWinner". Utifrån vilken av spelarmarkörerna det är som vunnit hämtar vi spelarens NickName ur listan "PlayersInSpecificGame" i "GameSession"-objektet. 
		
		
	* Controller 
Vi valde att enbart implementera en enda controller-klass, dels för att förenkla interaktionen mellan olika actionresult-metoder som interagerar med våra två olika views: FirstPage och ShowGameBoard, dels för att det var ett begränsat antal metoder som krävdes för att skapa önskade interaktionsmöjligheter med vår applikation. I actionResult-metoden "FirstPage" skapas en referens till ett Playerobjekt: "currentplayer", till denna tilldelas värdet som finns lagrat i HTTP-sessionsobjektet. Metoden kontrollerar ifall värdet i "currentPlayer" inte är null och om den specifika spelsessionen i så fall inte är över, ifall spelsessionen är pågående anropas metoden "RedirectToBoard" som hämtar spelarens pågående spel och omdirigerar så att detta visas i webbläsaren. 
